<!DOCTYPE html>
<html>

<head> 
    <meta charset="utf-8"> 
    <title>图书借阅</title> 
</head>

<body style="background-color: peachpuff;">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="JS/vue.js"></script>

    <template>
        <div>
            <!-- 表格 -->
            <el-table :data="tableData.slice((currentPage-1)*pageSize,currentPage*pageSize)" style="width: 100%">
                <el-table-column prop="ID" label="ID" width="180">
                </el-table-column>
                <el-table-column prop="name" label="用户" width="180">
                </el-table-column>
                <el-table-column prop="password" label="价格" width="180">               
                </el-table-column>
                <el-table-column prop="role" label="角色" width="180">
                </el-table-column>
                
            </el-table>
            <!-- 分页器 -->
            <div class="block" style="margin-top:15px;">
                <el-pagination align='center' @size-change="handleSizeChange" @current-change="handleCurrentChange" :current-page="currentPage" :page-sizes="[1,5,10,20]" :page-size="pageSize" layout="total, sizes, prev, pager, next, jumper" :total="tableData.length">
                </el-pagination>
            </div>
        </div>

        <el-pagination align='center' 
            @size-change="handleSizeChange" 
            @current-change="handleCurrentChange"
            :current-page="currentPage" 
            :page-sizes="[1,5,10,20]" 
            :page-size="pageSize" 
            layout="total, sizes, prev, pager, next, jumper" 
            :total="tableData.length">
        </el-pagination>
    </template>

    <script>
        export default {
            data() {
                return {
                    tableData:{},
                    currentPage: 1, // 当前页码
                    total: 7, // 总条数
                    pageSize: 1 // 每页的数据条数
                };
            },
			mounted(){
				this.getlivestockInfo(1);
			},
            methods: {
				//每页条数改变时触发 选择一页显示多少行
				handleSizeChange(val) {
				    console.log(`每页 ${val} 条`);
				    this.currentPage = 1;
				    this.pageSize = val;
				},
				//当前页改变时触发 跳转其他页
				handleCurrentChange(val) {
				    console.log(`当前页: ${val}`);
				    this.currentPage = val;
					this.getlivestockInfo(val);
				},
				getlivestockInfo(num1){
					var that = this;
					var params = new URLSearchParams();
					params.append('pageNum',num1);
					that.$axios.post('localhost:3000/api/v1/user',params)    //补上后台接口即可
					.then(response => {  // 请求成功
						console.log('请求成功');
						that.tableData=response.data.data;
						that.currentPage=num1;
						that.pageSize=that.tableData.pagesize;
						that.total=that.tableData.total;
						console.log(that.tableData.list.length);
					}).catch(error => {  // 请求失败
						console.log('请求失败');
						console.log(error);
					})
				}
                
            }
        };
    </script>



    <!-- html -->
   
</body>

</html>